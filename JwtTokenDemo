//
// Source code recreated from a .class file by IntelliJ IDEA
// (powered by Fernflower decompiler)
//

package in.careerpower.commons.auth.filters;

import io.jsonwebtoken.Claims;
import io.jsonwebtoken.JwtParser;
import io.jsonwebtoken.Jwts;
import io.jsonwebtoken.SignatureAlgorithm;
import io.jsonwebtoken.SignatureException;
import java.util.Date;

public class JwtHandler {
    private String base64EncodedSecretKey = "eXA1dTFvaVBPSVAz";
    private SignatureAlgorithm signatureAlgorithm;

    public JwtHandler() throws Exception {
        this.signatureAlgorithm = SignatureAlgorithm.HS512;
    }

    public String verify(String compactJwt) throws AccessDeniedException {
        try {
            JwtParser jwtParser = Jwts.parser().setSigningKey(this.base64EncodedSecretKey);
            return ((Claims)jwtParser.parseClaimsJws(compactJwt).getBody()).getSubject();
        } catch (SignatureException var3) {
            var3.printStackTrace();
            throw new AccessDeniedException("Access Denied");
        }
    }

    public String createJwtToken(String email) throws Exception {
        Claims claims = Jwts.claims();
        claims.setSubject(email);
        claims.setIssuedAt(new Date());
        claims.setIssuer("adda247.com");
        String jwtToken = Jwts.builder().setClaims(claims).signWith(this.signatureAlgorithm, this.base64EncodedSecretKey).compact();
        return jwtToken;
    }

    public String createJwtToken(String email, String name) throws Exception {
        Claims claims = Jwts.claims();
        claims.setSubject(email);
        claims.setIssuedAt(new Date());
        claims.setIssuer("adda247.com");
        claims.put("name", name);
        String jwtToken = Jwts.builder().setClaims(claims).signWith(this.signatureAlgorithm, this.base64EncodedSecretKey).compact();
        return jwtToken;
    }
}
